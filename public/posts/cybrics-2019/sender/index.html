<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<title>Sender - Cybrics Quals 2019</title>
	
	<meta name="description" content="">
	<meta name="image" content="">
	
	<meta itemprop="name" content="Sender - Cybrics Quals 2019">
	<meta itemprop="description" content="">
	<meta itemprop="image" content="">
	
	<meta name="og:title" content="Sender - Cybrics Quals 2019">
	<meta name="og:description" content="">
	
	<meta name="og:url" content="https://samirettali.com/posts/cybrics-2019/sender/">
	<meta name="og:site_name" content="Sender - Cybrics Quals 2019">
	<meta name="og:type" content="article">
	
	<meta name="article:tag" content="CTF CybricsQuals2019 ">
	<link rel="stylesheet" type="text/css" href="https://samirettali.com/css/style.css">
	
	
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-123-45', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>

<body>

<header>
	
	<a href="https://samirettali.com/" style="float: left;color:#ff3b30;">SE</a>
	
	
	
	<a href="https://samirettali.com/posts/index.xml" style="color:#777;float: right;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
</header>


<div class="content">
  <h1>Sender - Cybrics Quals 2019</h1>
  <aside><a href="/tags/ctf/">CTF</a></a>&nbsp;&nbsp;&nbsp;<a href="/tags/cybricsquals2019/">CybricsQuals2019</a></a>&nbsp;&nbsp;&nbsp;</aside>
  <p>

<p><img src="/images/cybrics-2019/sender/task.png" alt="Task" /></p>

<p>For this challenge, we have a link with some intercepted data:
<img src="/images/cybrics-2019/sender/data.png" alt="Data" /></p>

<p>It&rsquo;s the traffic incerception of a mail sent from <code>fawkes@ugm.cybrics.net</code>. The
body of the mail is encoded with the quoted-printable encoding. Let&rsquo;s save it in
a file and decode it:
<img src="/images/cybrics-2019/sender/mail-body.png" alt="Mail" /></p>

<p>So we do have the password for an archive. After a bit of thinkering I thought
to search if there are received mails. The default port for <code>POP3</code> is 110, so
let&rsquo;s try:
<img src="/images/cybrics-2019/sender/pop3.png" alt="POP3" /></p>

<p>Let&rsquo;s read the mail with <code>RETR 1:</code>
<img src="/images/cybrics-2019/sender/received-mail.png" alt="Received mail" /></p>

<p>The mail contains an attachment called <code>secret_flag.zip</code>. Let&rsquo;s use <code>tee</code> to
write the output of netcat to a file:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">nc ugm.cybrics.net 110 | tee received-mail</pre></div>
<p>and run the previous commands to authenticate and retrieve the mail.</p>

<p>We now have to use an editor to extract the base64 encoded attachment, so delete
the lines from 1 to 34 and from 1899 to 1901. We also have to remove the line
endings to obtain a valid base64 string.</p>

<p>I personally use vim and the command to remove all line endings is <code>:%s/\n//g</code>.</p>

<p>Let&rsquo;s create the archive and extract it:
<img src="/images/cybrics-2019/sender/archive.png" alt="Archive" /></p>

<p>Even if <code>base64 -d</code> says that the input is not valid, it&rsquo;s because <code>cat</code> adds a
new line at the end.</p>

<p>Opening the PDF file we find the flag:
<img src="/images/cybrics-2019/sender/pdf.png" alt="PDF" /></p>

<h3 id="flag">Flag</h3>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">cybrics{Y0uV3_G0T_m41L}</pre></div></p>
</div>


  <p>Written on Jul 21, 2019.</p>


<footer>
	<p>&copy; 2019 All rights reserved.</p>
</footer>
</body>
</html>
